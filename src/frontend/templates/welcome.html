<!doctype html>
<html lang="fr">

<head>
    <meta charset="utf-8">
    <title>Bienvenue</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/sty.css') }}">
</head>

<body>
    {% if user.isAuth %}
    <h1>Bienvenue {{ user.name }} !</h1>

    <div class="button-info-container">
        <div>
            <button id="loadQ" type="button">Recharger les questions</button>
        </div>
        <div id="resultMessage"></div>
    </div>
    <div class="card-container">
        <card class="scroll-card" id="scroll-card" style="display:none;">
            <table id="questionsTable">
                <thead>
                    <tr>
                        <th id="id">ID</th>
                        <th id="question">Question</th>
                        <th id="subject">sujet</th>
                        <th id="use">usage</th>
                        <th id="author">créé par</th>
                        <th id="date">date</th>
                        <th id="actions">actions</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </card>
    </div>

    <div class="button-info-container">
        <div>
            <button id="createQ" type="button">Créer une nouvelle question</button>
        </div>
        <div></div>
    </div>

    <div id="question-modal" style="display:none">
        <div class="card-container">
            <card class="question-detail" id="question-detail">
                <div class="question-title">
                    <h2 style="margin:0;">Création d'une nouvelle question</h2>
                    <button id="q-close-btn" type="button" aria-label="Fermer la fenêtre" title="Fermer">
                        <img src="{{ url_for('static', filename='/assets/icon-close.svg')}}">
                    </button>
                </div>
                <div class="q-question">
                    <label for="q-question-input">Intitulé</label>
                    <input id="q-question-input" type="text" name="question" placeholder="Saisir la question"
                        required />
                </div>

                <div class="q-subject">
                    <label for="q-subject-select">Sujets</label>
                    <div class="q-row">
                        <select id="q-subject-select" multiple size="4" aria-label="Subjects"></select>
                        <div class="q-adder">
                            <input id="q-subject-add" type="text" placeholder="Ajouter un sujet..." />
                            <button type="button" id="q-subject-add-btn">Ajouter un sujet</button>
                        </div>
                    </div>
                </div>

                <div class="q-use">
                    <label for="q-use-select">Usages</label>
                    <div class="q-row">
                        <select id="q-use-select" multiple size="4" aria-label="Uses"></select>
                        <div class="q-adder">
                            <input id="q-use-add" type="text" placeholder="Ajouter un usage..." />
                            <button type="button" id="q-use-add-btn">Ajouter un usage</button>
                        </div>
                    </div>
                </div>

                <div class="q-remark">
                    <label for="q-remark-input">Remarque</label>
                    <input type="txt" id="q-remark-input" name="remark" placeholder="Optionnel"></input>
                </div>

                <div class="q-info">
                    <div>Créé par :{{user.name}}</div>
                    <div>Créé le :</div>
                    <div>Modifié le :</div>
                    <div>
                        <label for="q-status-select">Statut</label>
                        <select id="q-status-select" name="status">
                            <option value="draft" selected>Brouillon</option>
                            <option value="active">Actif</option>
                            <option value="archive">Archivé</option>
                        </select>
                    </div>
                </div>

                <div class="q-response">
                    <div class="responses-header">
                        <span>Réponses</span>

                    </div>
                    <div id="responses-list"></div>
                    <template id="response-row-tpl">
                        <div class="response-row">
                            <input type="text" class="response-input" placeholder="Réponse..." />
                            <label class="correct-flag">
                                <input type="checkbox" class="response-correct" />
                                Correcte
                            </label>
                            <button type="button" class="remove-response">
                                <img src="{{ url_for('static', filename='/assets/icon-trash.svg')}}"></button>
                        </div>
                    </template>
                    <div class="response-row">
                        <button type="button" id="add-response-btn" class="response-input">
                            Ajouter une réponse</button>
                    </div>
                </div>

                <div class="q-buttons">
                    <button type="button" id="submit-btn">Enregistrer</button>
                    <button type="button" id="reset-btn" class="secondary">Réinitialiser</button>
                </div>
            </card>
        </div>
    </div>

    {% else %}
    <h1>Vous n'avez pas les droits.</h1>
    <p>Login ou mot de passe incorrect.</p>
    {% endif %}

    <script>
        window.APP_CONFIG = {
            token: "{{ token }}",
            apiUrl: "http://localhost:8000/api",
            userId: "{{ user.id }}"
        };
    </script>
    <script src="{{ url_for('static', filename='scripts/table.js') }}"></script>
    <script src="{{ url_for('static', filename='scripts/question_manager.js' )}}"></script>
</body>

</html>